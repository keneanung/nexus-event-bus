"use strict";(self.webpackChunkwebsite=self.webpackChunkwebsite||[]).push([[207],{3905:function(e,t,n){n.d(t,{Zo:function(){return u},kt:function(){return m}});var a=n(7294);function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function i(e,t){if(null==e)return{};var n,a,s=function(e,t){if(null==e)return{};var n,a,s={},l=Object.keys(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||(s[n]=e[n]);return s}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(a=0;a<l.length;a++)n=l[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(s[n]=e[n])}return s}var o=a.createContext({}),c=function(e){var t=a.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):r(r({},t),e)),n},u=function(e){var t=c(e.components);return a.createElement(o.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},d=a.forwardRef((function(e,t){var n=e.components,s=e.mdxType,l=e.originalType,o=e.parentName,u=i(e,["components","mdxType","originalType","parentName"]),d=c(n),m=s,b=d["".concat(o,".").concat(m)]||d[m]||p[m]||l;return n?a.createElement(b,r(r({ref:t},u),{},{components:n})):a.createElement(b,r({ref:t},u))}));function m(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var l=n.length,r=new Array(l);r[0]=d;var i={};for(var o in t)hasOwnProperty.call(t,o)&&(i[o]=t[o]);i.originalType=e,i.mdxType="string"==typeof e?e:s,r[1]=i;for(var c=2;c<l;c++)r[c]=n[c];return a.createElement.apply(null,r)}return a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},7480:function(e,t,n){n.r(t),n.d(t,{assets:function(){return u},contentTitle:function(){return o},default:function(){return m},frontMatter:function(){return i},metadata:function(){return c},toc:function(){return p}});var a=n(7462),s=n(3366),l=(n(7294),n(3905)),r=["components"],i={sidebar_position:4,id:"api"},o="API",c={unversionedId:"api",id:"api",title:"API",description:"eventBus.subscribe(event, callback, [callbackName], [overwrite])",source:"@site/docs/api.md",sourceDirName:".",slug:"/api",permalink:"/nexus-event-bus/docs/api",draft:!1,editUrl:"https://github.com/keneanung/nexus-event-bus/edit/development/website/docs/api.md",tags:[],version:"current",sidebarPosition:4,frontMatter:{sidebar_position:4,id:"api"},sidebar:"tutorialSidebar",previous:{title:"Using the event bus as an internal dependency for events",permalink:"/nexus-event-bus/docs/Advanced Usage/internal_events"},next:{title:"Standard Events",permalink:"/nexus-event-bus/docs/default_events"}},u={},p=[{value:"<code>eventBus.subscribe(event, callback, [callbackName], [overwrite])</code>",id:"eventbussubscribeevent-callback-callbackname-overwrite",level:2},{value:"Arguments",id:"arguments",level:3},{value:"Description",id:"description",level:3},{value:"Examples",id:"examples",level:3},{value:"<code>eventBus.raise(event, [data])</code>",id:"eventbusraiseevent-data",level:2},{value:"Arguments",id:"arguments-1",level:3},{value:"Description",id:"description-1",level:3},{value:"Examples",id:"examples-1",level:3},{value:"<code>eventBus.unsubscribe(event, callback)</code>",id:"eventbusunsubscribeevent-callback",level:2},{value:"Arguments",id:"arguments-2",level:3},{value:"Description",id:"description-2",level:3},{value:"Examples",id:"examples-2",level:3},{value:"<code>eventBus.getSubscribers(eventName)</code>",id:"eventbusgetsubscriberseventname",level:2},{value:"Arguments",id:"arguments-3",level:3},{value:"Return value",id:"return-value",level:3},{value:"Description",id:"description-3",level:3},{value:"Examples",id:"examples-3",level:3}],d={toc:p};function m(e){var t=e.components,n=(0,s.Z)(e,r);return(0,l.kt)("wrapper",(0,a.Z)({},d,n,{components:t,mdxType:"MDXLayout"}),(0,l.kt)("h1",{id:"api"},"API"),(0,l.kt)("h2",{id:"eventbussubscribeevent-callback-callbackname-overwrite"},(0,l.kt)("inlineCode",{parentName:"h2"},"eventBus.subscribe(event, callback, [callbackName], [overwrite])")),(0,l.kt)("h3",{id:"arguments"},"Arguments"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"event"),": ",(0,l.kt)("inlineCode",{parentName:"p"},"string")," - The name of the event to subscribe to."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"callback"),": ",(0,l.kt)("inlineCode",{parentName:"p"},"async function(object): void")," - The callback to call when the event is fired. The callback will retrieve the event data. It is called as a async function."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"callbackName"),": ",(0,l.kt)("inlineCode",{parentName:"p"},"string"),", optional - The name of the callback. If not provided, a random name will be generated."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"overwrite"),": ",(0,l.kt)("inlineCode",{parentName:"p"},"boolean"),", optional - If true, the callback will overwrite any existing callback with the same name. If false, the callback will only be added if there is no existing callback with the same name. An Error will be thrown if there is an existing callback with the same name and overwrite is false."),(0,l.kt)("h3",{id:"description"},"Description"),(0,l.kt)("p",null,"Adds the given function as a subscriber to the given event so it will be called  when the event is raised. The callback will be called as a async function, which means it may contain the ",(0,l.kt)("inlineCode",{parentName:"p"},"await")," keyword."),(0,l.kt)("p",null,"You may use the special event name ",(0,l.kt)("inlineCode",{parentName:"p"},"*")," to subscribe to all events."),(0,l.kt)("h3",{id:"examples"},"Examples"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'eventBus.subscribe("test", function(data) {\n    console.log("test event fired");\n    console.log(data);\n});\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'eventBus.subscribe("test", (data) => {\n    console.log("test event fired");\n    console.log(data);\n});\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'eventBus.subscribe("test", (data) => {\n    console.log("test event fired");\n    console.log(data);\n}, "myCallback");\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'const myVerySpecialFunction = (data) => {\n    console.log("test event fired");\n    console.log(data);\n}\n\neventBus.subscribe("test", myVerySpecialFunction, myVerySpecialFunction.name);\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'eventBus.subscribe("test", (data) => {\n    console.log("test event fired");\n    console.log(data);\n}, "myCallback");\n\neventBus.subscribe("test", (data) => {\n    console.log("test event fired");\n    console.log(data);\n}, "myCallback"); // Error\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'eventBus.subscribe("test", (data) => {\n    console.log("test event fired");\n    console.log(data);\n}, "myCallback");\n\neventBus.subscribe("test", (data) => {\n    console.log("test event fired");\n    console.log(data);\n}, "myCallback", true); // works\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'eventBus.subscribe("sawPlayer", async (name) => {\n    const response = await fetch(`https://api.achaea.com/characters/${name}.json`);\n    const json = await response.json();\n    console.log(json.fullname);\n});\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"eventBus.subscribe(\"*\", (data) => {\n    console.log('Got an event with data:');\n    console.log(data);\n});\n")),(0,l.kt)("h2",{id:"eventbusraiseevent-data"},(0,l.kt)("inlineCode",{parentName:"h2"},"eventBus.raise(event, [data])")),(0,l.kt)("h3",{id:"arguments-1"},"Arguments"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"event"),": ",(0,l.kt)("inlineCode",{parentName:"p"},"string")," - The name of the event to raise."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"data"),": ",(0,l.kt)("inlineCode",{parentName:"p"},"object"),", optional - The data to pass to the subscribers."),(0,l.kt)("h3",{id:"description-1"},"Description"),(0,l.kt)("p",null,"Raises the event with the given name and calls all subscribed callbacks. The callbacks receive the given data as their argument."),(0,l.kt)("p",null,(0,l.kt)("em",{parentName:"p"},"Note"),": This is an async function. If you want to wait for all events to have been raised before continuing the execution of your code, use ",(0,l.kt)("inlineCode",{parentName:"p"},"await eventBus.raise(event)")," in external JavaScript. If you call this in a Nexus script directly, ",(0,l.kt)("inlineCode",{parentName:"p"},"await")," can't be used and you must use Promises explicitly, see examples."),(0,l.kt)("h3",{id:"examples-1"},"Examples"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'eventBus.raise("test", "This is a test string");\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'eventBus.raise("test", {\n  content: "I have some nested data"\n});\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},"const name = 'Keneanung';\neventBus.raise(\"sawPlayer\", name);\n")),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'// Use this pattern inside Nexus scripts\neventBus.raise("test", "TestArgument").then(() => {\n    console.log("after all callbacks have run");\n});\nconsole.log("some time (non-deterministic, might be during the callback runs)");\n')),(0,l.kt)("h2",{id:"eventbusunsubscribeevent-callback"},(0,l.kt)("inlineCode",{parentName:"h2"},"eventBus.unsubscribe(event, callback)")),(0,l.kt)("h3",{id:"arguments-2"},"Arguments"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"event"),": ",(0,l.kt)("inlineCode",{parentName:"p"},"string")," - The name of the event to subscribe to."),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"callback"),": ",(0,l.kt)("inlineCode",{parentName:"p"},"async function(object): void")," or ",(0,l.kt)("inlineCode",{parentName:"p"},"string")," - The callback to remove from the list of functions that are called when the event is called. If a string is provided, it is assumed to be the name of the callback to remove instead."),(0,l.kt)("h3",{id:"description-2"},"Description"),(0,l.kt)("p",null,"Removes the given function as a subscriber to the given event so it will not be called anymore when the event is raised. This has to be the same reference as the one given to ",(0,l.kt)("inlineCode",{parentName:"p"},"eventBus.subscribe"),". If you do not want to keep the reference around, use the name of the callback instead."),(0,l.kt)("p",null,'To unsubscribe from the "all events" list, use the special event name ',(0,l.kt)("inlineCode",{parentName:"p"},"*"),"."),(0,l.kt)("h3",{id:"examples-2"},"Examples"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'function testFunction(data) {\n    console.log("test event fired");\n    console.log(data);\n}\n\neventBus.subscribe("test", testFunction);\neventBus.unsubscribe("test", testFunction);\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'function testFunction(data) {\n    console.log("test event fired");\n    console.log(data);\n}\n\neventBus.subscribe("test", testFunction, \'testFunction\');\neventBus.unsubscribe("test", \'testFunction\');\n')),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'const defence = {\n  dragon: () => {\n    console.log("I\'m a bulky dragon and I block everything.");\n  },\n  rajamalan: () => {\n    console.log("I\'m a quick rajamalan and I evade everything.");\n  },\n  none: () => {\n    console.log("I\'m a normal person and I can\'t defend.");\n  }\n}\n\neventBus.subscribe("raceChange", (raceChangeData) => {\n  eventBus.subscribe("defend", defence[raceChangeData.newRace]);\n  eventBus.unsubscribe("defend", defence[raceChangeData.oldRace]);\n});\n')),(0,l.kt)("h2",{id:"eventbusgetsubscriberseventname"},(0,l.kt)("inlineCode",{parentName:"h2"},"eventBus.getSubscribers(eventName)")),(0,l.kt)("h3",{id:"arguments-3"},"Arguments"),(0,l.kt)("p",null,(0,l.kt)("strong",{parentName:"p"},"eventName"),": ",(0,l.kt)("inlineCode",{parentName:"p"},"string")," - The name of the event to get the subscribers for."),(0,l.kt)("h3",{id:"return-value"},"Return value"),(0,l.kt)("p",null,"An array of objects in the form of ",(0,l.kt)("inlineCode",{parentName:"p"},"{callback: async function(object): void, callbackName: string}"),". The callback value is the actual callback function that is registered. The callbackName is the name of the callback that was given to ",(0,l.kt)("inlineCode",{parentName:"p"},"eventBus.subscribe"),"."),(0,l.kt)("h3",{id:"description-3"},"Description"),(0,l.kt)("p",null,"Use this function to retrieve all subscribed callbacks for the given event. The returned array is a copy of the internal data, so modifying it will not affect the internal array."),(0,l.kt)("p",null,'The array will contain the callbacks subscribed directly to the event as well as callbacks subscribed to the "all events" list.'),(0,l.kt)("h3",{id:"examples-3"},"Examples"),(0,l.kt)("pre",null,(0,l.kt)("code",{parentName:"pre",className:"language-js"},'function testFunction(data) {\n    console.log("test event fired");\n    console.log(data);\n}\n\neventBus.subscribe("test", testFunction);\neventBus.getSubscribers("test");\n// returns [{callback: testFunction, callbackName: <some random string>}]\n')))}m.isMDXComponent=!0}}]);